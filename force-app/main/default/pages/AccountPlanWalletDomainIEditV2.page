<apex:page standardController="AcctPlanWallet__c" extensions="AccountPlanWalletDomainIExV2"
    docType="html-5.0" showChat="false" showHeader="{! !isConsoleMode}" sidebar="false"
    applyBodyTag="false" applyHtmlTag="true" standardStylesheets="true">
    <head>
        <title></title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="author" content="Keattisak Chinburarat" />
        <meta http-equiv="content-type" content="text/html; charset=utf-8" />

        <!-- Static Resource -->
        <!--<apex:stylesheet value="{!URLFOR($Resource.bootstrapsf1, 'dist/css/bootstrap.min.css')}"/>  -->
        <apex:stylesheet value="{!URLFOR($Resource.bootstrapsf1, 'dist/css/bootstrap-namespaced.css')}" />
        <!--[if lt IE 9]><script src="../dist/js/ie8-responsive-file-warning.js"></script><![endif]-->

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
          <apex:includeScript value="{!$Resource.AccountPlan_HTML5shiv}"/>
          <apex:includeScript value="{!$Resource.AccountPlan_Respond}"/>
        <![endif]-->
        <apex:stylesheet value="{!$Resource.AccountPlanMaster}" />
        <style>
        
        
        .outputText {
            padding-top: 7px;
        }
        
        .outputQuestionnaireText {
            width: 15%;
        }
        .message .messageText h4 {
                display: flex;
        }

        </style>
    </head>

    <body>
        
        <div class="bootstrap-sf1 ">
            <div id="responseErrors"></div>
            <apex:form styleClass="form-horizontal">
                <apex:pageBlock id="pgBlock">
                        <apex:outputPanel id="result"> 
                         <apex:pageMessages id="errorMessage"   /> 
                        </apex:outputPanel>

                   <apex:actionFunction name="rerendercurrency" action="{!loadCurrency}" reRender="collectionblock,paymentblock,CollectionCurrencypanel,PaymentCurrencypanel"   />
                  <apex:actionstatus id="status">
                                                    <apex:facet name="start">
                                                        <div class='overlay' style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.75; z-index: 1000; background-color: #ededed;">
                                                             
                                                        </div>
                                                        <div style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 1001; margin: 15% 50%">
                                                            <img src="/img/loading32.gif" />
                                                        </div>
                                                    </apex:facet>
                          </apex:actionstatus>
                <fieldset>
                    <legend>Wallet by domain</legend>
                </fieldset>
                <div class="form-group">
                    <div style="text-align: center;">
                       <apex:pageBlockButtons location="both" style="float:left;margin-left:200px;" >
                <apex:commandButton value="Save"
                action="{!Save}" styleclass="btn btn-success" rerender="result" status="status" />
                <apex:commandButton value="Cancel" action="{!cancel}" styleclass="btn btn-success" onclick="if(!confirm('Are you sure you want to exit this screen without saving?')) return false;" />
            </apex:pageBlockButtons>
               
                  <!--  <apex:PageBlockSection id="result" columns="1" >
                    <apex:pageMessages /> 
                </apex:PageBlockSection>  -->                                    
                    </div>
                </div>
                <header class="navbar navbar-default navbar-branded" role="banner">
                    <div class="panel-heading">
                        <div class="navbar-header ">
                            <a data-toggle="collapse" aria-expanded="true" href="#collapse1"
                                class="navbar-brand navbar-foundation-logo"> Collection Flow </a>
                        </div>
                    </div>
                </header>
                <div class="card collapse in panel-collapse" id="collapse1">
                    <div class="card-detail">
                        <!--  Section 1 -->
                        <fieldset>
                           
                            <div>

                                <div class="col-sm-12 col-md-6 col-lg-6">
                                    <div class="form-group">
                                     

                                            <div>
                                                <table class="table">
                                                    <tr>
                                                        <td class="text-left" style="border: none;"><label
                                                            class="control-label">Unit: THB</label></td>
                                                        <td style="border: none;"> </td>
                                                        <td style="border: none;"> </td>
                                                        
                                                    </tr>
                                                    <tr>
                                                        <td class="text-left forceBackground" style="border: none;">
                                                            
                                                        </td>
                                                        <td class="text-right forceBackground" style="border: none;">
                                                            <label class="control-label">Sale portion (%)</label>
                                                        </td>
                                                        <td class="text-right forceBackground" style="border: none;">
                                                            <label class="control-label">Amount/Year</label>
                                                        </td>
                                                    </tr>                                          
                                                    <tr>
                                                        <td class="text-left forceBackground" style="border: none;">
                                                            <label  class="control-label" style="text-align: left !important;">Estimated
                                                                Sales (Year of account plan ) : 
                                                            </label>
                                                        </td>
                                                        <td class="text-right" style="border: none;">
                                                            
                                                            
                                                            <apex:outputfield value="{!wallet.EstimatedSalesPercent__c}" styleClass="form-control"
                                                                 />
                                                                    <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                                  
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.EstimatedSalesPercent__c.inlineHelpText}" />      
                                                                </td>
                                                        <td style="border: none;">
                                                                                     <apex:inputfield value="{!wallet.EstimatedSalesAmtPerYear__c}" styleClass="{!if(wallet.EstimatedSalesAmtPerYear__c == null || wallet.EstimatedSalesAmtPerYear__c == 0,'danger','success')} form-control text-right "
                                                                 onchange="checkIshasValue(this,'');" style="width:90%;float:left;" />
                                                                          <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                                            style="float: left;margin-left: 7px;margin-top: 10px;"
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.EstimatedSalesAmtPerYear__c.inlineHelpText}" />
                                    
                                                                     </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="text-left forceBackground" style="border: none;">
                                                            <label 
                                                            class="control-label">Total Sales Domestic :</label>
                                                        </td>
                                                        <td style="border: none;">
                                                            <!-- onchange="checkIshasValue(this,'CollectionDomestictable');" -->
                                                            <apex:inputfield value="{!wallet.TotalDomesticPercent__c}" styleClass="{!if(wallet.TotalDomesticPercent__c == null ,'danger','success')} form-control text-right "
                                                                style="width:90%;float:left;"  onchange="checkIshasValue(this,'TotalDomesticPercent');"/>
                                                                    <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                                    style="float: left;margin-left: 7px;margin-top: 10px;"
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalDomesticPercent__c.inlineHelpText}" />     
                                                         
                                                         
                                                            </td>
                                                        <td class="text-right" style="border: none;">
                                                            <apex:outputfield value="{!wallet.TotalDomesticAmtPerYear__c}" styleClass="form-control"
                                                                 />
                                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalDomesticAmtPerYear__c.inlineHelpText}" />     
                                                                </td>
                                                    </tr>
                                                    <tr>
                                                        <td class="text-left forceBackground" style="border: none;">
                                                            <label 
                                                            class="control-label">Total Sales Export :</label>
                                                        </td>
                                                        <td class="text-right" style="border: none;">
                                                            <apex:outputfield value="{!wallet.TotalExportPercent__c  }" styleClass="form-control"
                                                                 />
                                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalExportPercent__c.inlineHelpText}" />     
                                                                </td>
                                                        <td class="text-right" style="border: none;">
                                                            <apex:outputfield value="{!wallet.TotalExportAmtPerYear__c  }" styleClass="form-control"
                                                                />
                                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalExportAmtPerYear__c.inlineHelpText}" />     
                                                                </td>
                                                    </tr>
                                                </table> 
                                                          
                                            </div>

                                    </div>
                                </div>

                              

                            </div>
                                
                                                     
                            
                                        
                                                
                                 
                                                
                                                
                            <div>
                                <br/>
                                                                
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                            <td colspan="3">
                                                <p id="CollectionDomestic" class="bg-danger text-center" style="display:{!if(isRequiredCollectionMethod,'block','none')}; float: left;padding: 8px;border: 1px solid #E28888;">
                                                    <!--If Sales Domestic is more than 0, there must be at least one product with %Vol. of more than 0-->
                                                    {!msgSalesDomestic}

                                                </p>
                                                    
                                               <p id="BillPayment" class="bg-danger text-center" style="display:{!if(isRequiredBillPayment,'block','none')}; float: left;padding: 8px;border: 1px solid #E28888;margin-left:10px;margin-top:10px;">
            
                                               <!--Conditional Field - If %Vol of Bill Payment is more than 0%, No. of transactions is required   -->
                                               {!msgRequiredBillPayment }
                                                </p>
                                            </td>  


                                        </tr>
                                        <tr>
                                            <td class="text-left" style="border: none;"><label
                                                        class="control-label">Unit: THB</label>
                                            </td>
                                                          
                                        </tr>
                                        <tr>
                
                                            <th rowspan="2" style="vertical-align: middle;width:120px;">Collection
                                                                Method<br />(Domestic)
                                                                  <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.Label__c.inlineHelpText}" />       
                                                                </th>
                                            <th rowspan="2" style="vertical-align: middle;">No. of
                                                                transactions<br />(Average per Month)
                                                                  <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.NoOfTransaction__c.inlineHelpText}" />       

                                                                </th>
                                            <th rowspan="2" style="vertical-align: middle;">Domestic
                                                                (Vol.)<br />(Average per Month)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.Volume__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">% Vol.
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.VolumePercent__c.inlineHelpText}" />       

                                            </th>
                                            <th colspan="5" style="vertical-align: middle;">%TMB Share
                                                                vs %Other Banks share</th>
                                            <th rowspan="2" style="vertical-align: middle;">Standard Fee<br />(Reference)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.StandardFee__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Fee Charge<br/>(adjust by RM)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.FeeCharge__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Wallet Cash<br />Fee(Yearly)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.WalletFee__c.inlineHelpText}" />       

                                            </th>
                                        </tr>
                                        <tr>
                                            <th style="vertical-align: middle; padding:15px;">%Share-<br />TMB
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.SharedTMB__c.inlineHelpText}" />       

                                            </th>
                                                <th style="padding: 15px;">%Share -
                                                    
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.SharedBank1__c.inlineHelpText}" /> 
                                                         <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankCollectionDomestic.SharedBank1__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                        
                                                </th>  
                                                <th  style="padding: 15px;">%Share -
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.SharedBank2__c.inlineHelpText}" />   
                                                         <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankCollectionDomestic.SharedBank2__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                                                                       </th>
                                                <th  style="padding: 15px;">%Share -
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.SharedBank3__c.inlineHelpText}" />     
                                                         <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankCollectionDomestic.SharedBank3__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                         

                                                </th>
                                               <th  style="padding: 15px;">%Share -
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.SharedBank4__c.inlineHelpText}" />       
                                                         <br />

                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankCollectionDomestic.SharedBank4__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                        
                                                </th>
                                        </tr>
                                    </thead>
                                     <tbody> 
                                                     <apex:repeat value="{!fdetailMap['Collection Domestic']}" var="CDdetail" >
                                                          <apex:variable value="{!fheaderMap[CDdetail.Account_Plan_Flow_Header__c]}" var="CDHeader" /> 
                                                                    
                                                 <tr class="" >
                                                     <td class="text-left forceBackground" >{!CDHeader.Label__c}
                                                    
                                                     </td>
                                                     
                                                     <td class="text-right">
                                                         
                                                   <apex:inputfield value="{!CDdetail.NoOfTransaction__c }"  
                                                       styleClass=" form-control text-right fillin"
                                                         style="width:70px;float:right;display:{!if(CDHeader.isNoTransactions__c==true,'block','none')};" />
                                                  </td>
                                                      <td class="text-right">
                                                    <apex:outputfield value="{!CDdetail.Volume__c}" styleClass="form-control text-right"
                                                      style="width:70px;float:right;"
                                                      rendered="{!CDdetail.Volume__c !=null&& CDdetail.Volume__c !=0}" />
                                                  </td>
                                                       <td class="text-right">
                                                <apex:outputfield value="{!CDdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                   rendered="{!
                                                   if( !CDHeader.isVolumePercent__c ,
                                                   if(CDdetail.VolumePercent__c !=null 
                                                      && CDdetail.VolumePercent__c !=0 ,true,false),false)}"   
                                                   style="width:70px;float:right;" />
                                                       
                                                <apex:inputfield value="{!CDdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isVolumePercent__c}"   style="width:70px;float:right;" />
                                                   
                                            </td>
                                                  <td class="text-right" >
                                               <apex:inputfield value="{!CDdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CDdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CDHeader.isVolumePercent__c,if(CDdetail.SharedTMB__c !=null && CDdetail.SharedTMB__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!CDdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CDdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CDHeader.isVolumePercent__c,if(CDdetail.SharedTMB__c !=null && CDdetail.SharedBank1__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                <apex:inputfield value="{!CDdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CDdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CDHeader.isVolumePercent__c,if(CDdetail.SharedTMB__c !=null && CDdetail.SharedBank2__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>        
                                             <td class="text-right" >
                                                 <apex:inputfield value="{!CDdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CDdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CDHeader.isVolumePercent__c,if(CDdetail.SharedTMB__c !=null && CDdetail.SharedBank3__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>    
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!CDdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CDdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CDHeader.isVolumePercent__c,if(CDdetail.SharedTMB__c !=null && CDdetail.SharedBank4__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>        
                                                    
                                            
                                                     
                                              <td class="text-right {!if(CDdetail.StandardFee__c !=null && CDdetail.StandardFee__c != 0,'forceBackground','')}">
                                               <apex:outputfield value="{!CDdetail.StandardFee__c}"
                                                    rendered="{!if(
                                                    CDdetail.StandardFee__c !=null 
                                                    && CDdetail.StandardFee__c != 0 
                                                    && CDHeader.isFreeCharge__c 
                                                    && CDHeader.Fee_Charge_Type__c =='Percent'
                                                    ,'true','false')}"
                                                />
                                                        
                                                        <apex:outputtext value="{0, number, ###,##0.00}"
                                                        
                                                        rendered="{!if(
                                                        CDHeader.isFreeCharge__c 
                                                        && CDdetail.StandardFee__c !=null 
                                                        && CDdetail.StandardFee__c != 0
                                                        && CDHeader.Fee_Charge_Type__c =='Number'
                                                        ,'true','false')}" >
                                                                        <apex:param value="{!CDdetail.StandardFee__c}" />
                                                         </apex:outputtext>
                                                </td> 
                                                                        
                                                <td class="text-right">
                                                 <apex:inputfield value="{!CDdetail.FeeCharge__c}" 
                                                 styleClass="form-control text-right fillin"
                                                    rendered="{!CDHeader.isFreeCharge__c }"   
                                                    style="width:70px;float:right;" />
                                                        
                                                       
                                                </td> 
                                                    
                                                     <td class="text-right">
                                                <apex:outputfield value="{!CDdetail.CD_WalletFee__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDdetail.Account_Plan_Flow_Header__r.isFreeCharge__c 
                                                    && CDdetail.FeeCharge__c !=null 
                                                    && if( CDdetail.CD_WalletFee__c !=null,true,false) }"  
                                                    style="width:70px;float:right;" />
                                                    
                                                <!-- /******************** BAU Issue 00005057 2017-02-27 ********************/
                                                <apex:outputfield value="{!CDdetail.CD_WalletFee__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CDdetail.Account_Plan_Flow_Header__r.isFreeCharge__c 
                                                    && CDdetail.FeeCharge__c !=null 
                                                    && if( CDdetail.CD_WalletFee__c !=null,if(CDdetail.CD_WalletFee__c>0,true,false ),false) }"
                                                    style="width:70px;float:right;" />
                                                /******************** BAU Issue 00005057 2017-02-27 ********************/ -->  

                                                    
                                                    <apex:outputtext value="{0, number, ###,##0}"
                                                        
                                                         rendered="{! CDdetail.ID ==null 
                                                         && legacyWalletFeeMap[CDHeader.id] >0 }" >
                                                                        <apex:param value="{!legacyWalletFeeMap[CDHeader.id]}" />
                                                         </apex:outputtext>

                                            
                                                </td>     
                                                     
                                                     
                                                     </tr>
                                            
                                       </apex:repeat>
                                       <tr class="info endRow">
                                            <td class="text-left forceBackground">Total</td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"><apex:outputfield value="{!wallet.SumOfCollectionDomesticVolumn__c}" /></td>
                                            <td class="text-right"><apex:outputfield value="{!wallet.SumOfCollectionVolumnPercent__c }" /></td>
                                            <td colspan="6"> </td>
                                            
                                            <td> </td><td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfCollectionWalletCashFee__c }"   />
                                            </td>
                                        </tr>
                                    
                                    </tbody>
                                </table>
                            </div>
                                                                                  
                            <!-- Start >> 17Aug2015 :by DA -->
                            <br /><br /> 
                            <div>
                                <table class="table table-striped table-hover" style="width:50%;" id="domesticcollectiontable">                                   
                                    <thead>
                                        <tr >
                                            <th colspan="2">Domestic collection Method</th>
                                            
                                            <th style="width:150px;">Business Opportunity</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                                <apex:variable var="rowNum" value="{!1}" />
                                         <apex:variable var="domesticStr" value="Domestic Collection Method" />     
                                             <apex:repeat value="{!QuestionnaireMap[domesticStr]}" var="qm" >                                                
                                       <tr >
                                                <td style="width:120px;" >
                                              <apex:inputField value="{!qm.Answer__c}" 
                                              styleClass=" form-control fillin" style="height:30px;" onchange="showOpportunity(this,{!rowNum},'domesticcollectiontable');" />
                                                </td>
                                                <td class="forceBackground text-left" >{!qm.Question__c}
                                                <br />
                                                {!qm.Question_TH__c}</td>
                                              <td style="width: 150px;"  id="Oppty{!rowNum}"
                                              class="text-left {!IF(qm.Answer__c == 'Yes','','display-none')}">
                                                  {!qm.Opportunity__c}
                                              </td>
                                            </tr>
                                              <apex:variable var="rowNum" value="{!rowNum + 1}" />
                                            </apex:repeat>
                                            
                                    </tbody>                                    
                                </table>
                            </div>                            
                            <!-- End >> 17Aug2015 :by DA -->
                            
                            <div style="overflow-x: scroll;">
                                <br />
                                <table class="table table-striped table-hover">
                                    <thead>
                                        <tr>
                                        <td colspan="5">
                                                <p id="CollectionExportError" class="bg-danger text-center" style="display:{!if(isRequiredColletionExport ,'block','none')}; float: left;padding: 8px;border: 1px solid #E28888;">
                                                    <!--If Sales Export is more than 0, there must be at least one product with %Vol. of more than 0-->
                                                    {!msgSalesExport}

                                                </p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left" style="border: none;"><label
                                                        class="control-label">Unit: THB</label>
                                            </td>
                                               
                                        </tr>
                                        <tr>
                                            <th rowspan="2" style="vertical-align: middle;">Collection
                                                Method<br />(Export)
                                                  <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.Label__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Term<br />(Days)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.TermDays__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Collection pattern
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.Pattern__c.inlineHelpText}" />       

                                            </th>
                                                     
                                                      <th rowspan="2" style="vertical-align: middle;">No. of transactions
                                                        <br />Average per Month
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionDomestic__c.Fields.NoOfTransaction__c.inlineHelpText}"  />       

                                            </th>       
                                            <th rowspan="2" style="vertical-align: middle;">Export
                                                (Vol.)<br />Average per Month
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.Volumn__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">% Vol.
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.VolumnPercent__c.inlineHelpText}" />       
</th>
                                            <th colspan="5">%TMB Share vs %Other Banks share</th>
                                            <th rowspan="2" style="vertical-align: middle">Standard Fee<br />(Reference)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.StandardFee__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle">Fee charge <br />(adjust by RM)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.FeeCharge__c.inlineHelpText}" />       

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle">Wallet Trade<br />Fee (Yearly)
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.WalletCashFee__c.inlineHelpText}" />       

                                            </th>
                                        </tr>
                                        <tr>
                                            <th style="vertical-align: middle; padding: 15px;">%Share-<br />TMB
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.SharedTMB__C.inlineHelpText}" />       

                                            </th>
                                            <th style="padding: 15px;">%Share -
                                                  <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.SharedBank1__c.inlineHelpText}" />       

                                                <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankCollectionExport.SharedBank1__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>  
                                                <th  style="padding: 15px;">%Share -
                                                      <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.SharedBank2__c.inlineHelpText}" />       

                                                    <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankCollectionExport.SharedBank2__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                                <th  style="padding: 15px;">%Share -
                                                      <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.SharedBank3__c.inlineHelpText}" />       

                                                    <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankCollectionExport.SharedBank3__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                               <th  style="padding: 15px;">%Share -
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionExport__c.Fields.SharedBank4__c.inlineHelpText}" />       

                                                   <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankCollectionExport.SharedBank4__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                        </tr>
                                    </thead>
                                     <tbody>
                                        
                                                 <apex:repeat value="{!fdetailmap['Collection Export']}" var="CEdetail" >
                                                          <apex:variable value="{!fheaderMap[CEdetail.Account_Plan_Flow_Header__c]}" var="CEheader" /> 
                                                              
                                         
                                             
                                                 <tr class="">
                                                     <td class="text-left forceBackground" >{!CEheader.Label__c}
                                                     
                                                     </td>
                                                     
                                                     <td class="text-right">
                                               <apex:inputfield value="{!CEdetail.TermDays__c}"  styleClass=" form-control text-right fillin"
                                                       rendered="{!CEheader.isTerm__c }"  style="width:70px;float:right;" />
                         
                                                  </td>
                                                       
                                                       <td class="text-right">
                                                <apex:inputfield value="{!CEdetail.Pattern__c }" styleClass="form-control text-right fillin"
                                                    />  
                                                    </td>
                                                
                                                  <td class="text-right">
                                               <apex:inputfield value="{!CEdetail.NoOfTransaction__c}"  styleClass=" form-control text-right fillin"
                                                         style="width:70px;float:right;display:{!if(CEheader.isNoTransactions__c,'block','none')};" />
                         
                                                  </td>
                                                       
                                                       <td class="text-right">
                                              <apex:outputfield value="{!CEdetail.Volume__c}" styleClass="form-control text-right"
                                                      style="width:70px;float:right;"
                                                      rendered="{!CEdetail.Volume__c !=null&& CEdetail.Volume__c !=0}" />
                                               </td>
                                                      
                                          <td class="text-right">
                                                <apex:outputfield value="{!CEdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                   rendered="{!
                                                   if( !CEheader.isVolumePercent__c ,
                                                   if(CEdetail.VolumePercent__c !=null 
                                                      && CEdetail.VolumePercent__c !=0 ,true,false),false)}"   
                                                   style="width:70px;float:right;" />
                                                       
                                                <apex:inputfield value="{!CEdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEheader.isVolumePercent__c}"   style="width:70px;float:right;" />
                                                                                                
                                                
                                            </td>
                                                   
                                             <td class="text-right" >
                                               <apex:inputfield value="{!CEdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEheader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CEdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CEheader.isVolumePercent__c,if(CEdetail.SharedTMB__c !=null && CEdetail.SharedTMB__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!CEdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEheader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CEdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CEheader.isVolumePercent__c,if(CEdetail.SharedTMB__c !=null && CEdetail.SharedBank1__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                <apex:inputfield value="{!CEdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEheader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CEdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CEheader.isVolumePercent__c,if(CEdetail.SharedTMB__c !=null && CEdetail.SharedBank2__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>        
                                             <td class="text-right" >
                                                 <apex:inputfield value="{!CEdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEheader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CEdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CEheader.isVolumePercent__c,if(CEdetail.SharedTMB__c !=null && CEdetail.SharedBank3__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>    
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!CEdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEheader.isVolumePercent__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!CEdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!CEheader.isVolumePercent__c,if(CEdetail.SharedTMB__c !=null && CEdetail.SharedBank4__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>        
                                                    
                                            
                                                     
                                              <td class="text-right {!if(CEdetail.StandardFee__c !=null && CEdetail.StandardFee__c != 0,'forceBackground','')}">
                                               <apex:outputfield value="{!CEdetail.StandardFee__c}"
                                                    rendered="{!if(
                                                    CEdetail.StandardFee__c !=null 
                                                    && CEdetail.StandardFee__c != 0 
                                                    && CEheader.isFreeCharge__c 
                                                    && CEheader.Fee_Charge_Type__c =='Percent'
                                                    ,'true','false')}"
                                                />
                                                        
                                                        <apex:outputtext value="{0, number, ###,##0.00}"
                                                        
                                                        rendered="{!if(
                                                        CEheader.isFreeCharge__c 
                                                        && CEdetail.StandardFee__c !=null 
                                                        && CEdetail.StandardFee__c != 0
                                                        && CEheader.Fee_Charge_Type__c =='Number'
                                                        ,'true','false')}" >
                                                                        <apex:param value="{!CEdetail.StandardFee__c}" />
                                                         </apex:outputtext>
                                                </td> 
                                                                        
                                                <td class="text-right"> 
                                                 <apex:inputfield value="{!CEdetail.FeeCharge__c}" 
                                                 styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(CEheader.isFreeCharge__c,'block','none')};" />
                                                        
                                                       
                                                </td> 
                                                    
                                                     <td class="text-right">
                                                     
                                                <apex:outputfield value="{!CEdetail.CD_WalletFee__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEdetail.Account_Plan_Flow_Header__r.isFreeCharge__c && 

                                                     if( CEdetail.CD_WalletFee__c !=null,true,false) &&

                                                    CEdetail.id !=null }"   
                                                    style="width:70px;float:right;" />
                                                 
                                                <!-- /******************** BAU Issue 00005057 2017-02-27 ********************/
                                                <apex:outputfield value="{!CEdetail.CD_WalletFee__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!CEdetail.Account_Plan_Flow_Header__r.isFreeCharge__c && 

                                                     if( CEdetail.CD_WalletFee__c !=null,if(CEdetail.CD_WalletFee__c>0,true,false ),false) &&

                                                    CEdetail.id !=null }"   
                                                    style="width:70px;float:right;" />
                                                /******************** BAU Issue 00005057 2017-02-27 ********************/ -->

                                                     <apex:outputtext value="{0, number, ###,##0}"
                                                        
                                                         rendered="{! CEdetail.ID ==null 
                                                         && legacyWalletFeeMap[CEheader.id] >0 }" >
                                                                        <apex:param value="{!legacyWalletFeeMap[CEheader.id]}" />
                                                         </apex:outputtext>
                                            
                                                </td>
                                                     
                                                     
                                                     </tr>
                                            
                                       </apex:repeat>
                                        <tr class="info endRow">
                                            <td class="text-left forceBackground">Total</td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"><apex:outputfield value="{!wallet.TotalExportAvgPerMonth__c}" /></td>
                                            <td class="text-right"><apex:outputfield value="{!wallet.SumOfCollectionExportVolPercent__c}" /></td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfCollectionExportWalletTradeFee__c}" /></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>  
                            
                            <!-- Start >> 17Aug2015 :by DA -->
                            <br /><br /> 
                            <div>
                                <table class="table table-striped table-hover" style="width:50%;" id="exportcollectiontable">                                   
                                    <thead>
                                        <tr >
                                            <th colspan="2">Export collection method</th>
                                            
                                                
                                            <th>Business Opportunity</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                       
                                                <apex:variable var="rowNum" value="{!1}" />
                                        <apex:variable var="exportstr" value="Export Collection Method" /> 
                                             <apex:repeat value="{!QuestionnaireMap[exportstr]}" var="qm" >                                                      
                                       <tr >
                                                <td style="width:120px;" >
                                              <apex:inputField value="{!qm.Answer__c}" 
                                              styleClass=" form-control fillin" style="height:30px;" onchange="showOpportunity(this,{!rowNum},'exportcollectiontable');" />
                                                </td>
                                                <td class="forceBackground text-left" >{!qm.Question__c}
                                                <br />
                                                {!qm.Question_TH__c}</td>
                                              <td style="width: 150px;"  id="Oppty{!rowNum}"
                                              class="text-left {!IF(qm.Answer__c == 'Yes','','display-none')}">
                                                  {!qm.Opportunity__c}
                                              </td>
                                            </tr>
                                              <apex:variable var="rowNum" value="{!rowNum + 1}" />
                                            </apex:repeat>
                                    </tbody>                                    
                                </table>
                            </div>                            
                            <!-- End >> 17Aug2015 :by DA -->
                            
                            <div>
                                <br />
                                 <div class="row" style="padding-bottom: 3px;"> 
                                        <div class="col-sm-12 col-md-6 col-lg-6" style="width:40%;">      
                                              <a href="#" class="btn  btn-success" data-toggle="collapse" aria-expanded="true" id="collectionUI">Add / Edit Collection Currency</a>   
                                              
                                              <apex:outputpanel id="CollectionCurrencypanel" >
                                              <div  style="float:right;margin-right:50px;display:{!if(isCollectCurrencyNull,'block','none')};"> 
                                                    <p class='bg-danger text-center' style=' float: left;padding: 8px;border: 1px solid #E28888;margin-left:10px;margin-top: 20px;font-size:15px;'>
                                                       <!--If Sales Export is more than 0, there must be at least one record of Collection Currency-->
                                                       {!msgCollectionCurrency}
                                                    </p>
                                                    
                                                </div>
                                                       </apex:outputpanel>
                                                       
                                        </div>         
                                    </div> 
                                              <br />
                               <apex:outputpanel id="collectionblock">
                                <table class="table table-striped table-hover" id="collectiontable"
                                    style="width: 50%">
                                   <thead>
                                        <tr>
                                            <td class="text-left" style="border: none;"><label
                                                        class="control-label">Unit: THB</label>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Collection Currency
                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionOrPaymentCurrency__c.Fields.CCY__c.inlineHelpText}" />
                             
                                            </th>
                                            <th>Portion (%)
                                                         <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionOrPaymentCurrency__c.Fields.CollectionPortion__c.inlineHelpText}" />
                                                         </th>
                                            <th>Amount per year (THB)
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionOrPaymentCurrency__c.Fields.CollectionAmtPerYear__c.inlineHelpText}" />
                                                     </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <apex:variable var="totalCollectionCCY" value="{!0}" />     
                                        <apex:variable var="totalCollectionAmt" value="{!0}" />
                                                   
                                        <apex:repeat value="{!CollectionList}" var="cl" >               
                                         <tr>
                                            <td>
                                                <apex:outputtext value="{!cl.CCY__r.ShortName__c}"/>
                                            </td>
                                            <td class="text-center">
                                            <apex:outputfield value="{!cl.CollectionPortion__c}" />
                                            </td>
                                            <td class="text-right">
                                            <apex:outputfield value="{!cl.CollectionAmtPerYear__c}" /> 
                                            </td>
                                        </tr>
                                                <apex:variable var="totalCollectionCCY" value="{!totalCollectionCCY + cl.CollectionPortion__c}" />
                                                <apex:variable var="totalCollectionAmt" value="{!totalCollectionAmt + cl.CollectionAmtPerYear__c}" />
                                        </apex:repeat>        
                                            <tr class="info endRow">
                                                <td class="text-center">Total</td>
                                                <td class="text-center"><apex:outputText value="{!totalCollectionCCY}"/>%</td>
                                                <td class="text-right">
                                                    <apex:outputText value="{0, number, ###,##0}">
                                                        <apex:param value="{!totalCollectionAmt}" />
                                                    </apex:outputText>
                                                </td>
                                            </tr> 
                                   </tbody>            
                                      
                                </table>
                                   </apex:outputpanel>         
                            </div>
                            
                            <div>
                            <br />
                            <table class="table table-striped table-hover" style="width: 40%">
                                <thead>
                                  
                                      <apex:variable var="exportstr" value="Collection Questionnaire" />  
                                      <apex:variable var="internetbankingCollection" value="" /> 
                                             <apex:repeat value="{!QuestionnaireMap[exportstr]}" var="qm" >
                                                
                                                 <apex:variable var="internetbankingCollection" value="{!qm.Answer__c}" rendered="{!IF(qm.Answer__c == 'Yes' && qm.SEQ__c == 1,true,false)}"/>
                                                 <tr style="display:{!IF(internetbankingCollection == 'Yes' || qm.SEQ__c == 1,'table-row','none')};" class="{!IF(qm.SEQ__c != 1,'internetbankingCollection','')}">
                                                        <td class="forceBackground text-left" style="width:120px;">
                                                            <apex:inputfield value="{!qm.Answer__c}" styleClass="form-control fillin"
                                                             style="width:120px;" onchange="internetbanking('{!qm.SEQ__c}',this,'Collection')"/>
                                                        </td>
                                                        <td class="forceBackground text-left" >
                                                            {!qm.Question__c}
                                                            <br />
                                                            {!qm.Question_TH__c}
                                                         </td>
                                                         
                                                </tr>
                                             </apex:repeat>
                                        
                                  
                                </thead>
                            </table>
                                
                            </div>
                            
                        </fieldset>
                        
                        
                        
                        
                    </div>
                </div>
                <br />
                <header class="navbar navbar-default navbar-branded" role="banner">
                    <div class="panel-heading">
                        <div class="navbar-header ">
                            <a data-toggle="collapse" aria-expanded="true" href="#collapse2"
                                class="navbar-brand navbar-foundation-logo"> Payment Flow </a>
                        </div>
                    </div>
                </header>
               <div class="card collapse in panel-collapse" id="collapse2">
                    <div class="card-detail">
                        <!--  Section 1 -->
                        
                        <fieldset>
                            
                             <div>

                                <div class="col-sm-12 col-md-12 col-lg-5">
                                    <div class="form-group">

                                        <div>
                                        
                                            <table class="table table-striped">
                                                <tr>
                                                    <td class="text-left" style="border: none;"><label
                                                        class="control-label" wihth="50%">Unit: THB</label></td>
                                                    <td style="border: none;" width="25%"> </td>
                                                    <td style="border: none;" wihth="25%"> </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-left forceBackground" style="border: none;">
                                                        % COGS (From estimated sales)
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.COGSPercent__c.inlineHelpText}" />
                  
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                       
                                                       
                                                       <apex:inputfield value="{!wallet.COGSPercent__c}" onchange="checkIshasValue(this,'COGSPercent');" 
                                                       styleClass="form-control text-right {!if(wallet.COGSPercent__c == null ,'danger','success')}"
                                                   />
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-left forceBackground" style="border: none;">
                                                        COGS (Amount: THB)
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.COGSAmount__c.inlineHelpText}" />
                  
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                        <apex:inputfield value="{!wallet.COGSAmount__c }" styleClass="form-control text-right"
                                                   />
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-left forceBackground" style="border: none;">
                                                        Operating Expense (Amount: THB)
                                                         <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.OperatingExpAmount__c.inlineHelpText}" />

                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                        <apex:inputfield value="{!wallet.OperatingExpAmount__c }" 
                                                        onchange="checkIshasValue(this,'OperatingExpAmount');" 
                                                        styleClass="form-control text-right {!if(wallet.OperatingExpAmount__c == null,'danger','success')}"
                                                   />
                                                        
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-left forceBackground" style="border: none;">
                                                        Total Payment (Amount: THB)        
                                                         <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalPayment__c.inlineHelpText}" />

                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                         <apex:inputfield value="{!wallet.TotalPayment__c }" styleClass="form-control text-right "
                                                   />
                                                        
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                    Amount per year<br/>
                                                    (Unit: THB)
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-left forceBackground" style="border: none;">
                                                        Total Payment Domestic      
                                                        
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                        <apex:inputfield value="{!wallet.TotalPaymentDomesticPercent__c}" 
                                                        onchange="checkIshasValue(this,'TotalPaymentDomesticPercent');" 
                                                        style="width:87%;float:left;"
                                                        styleClass="{!if(wallet.TotalPaymentDomesticPercent__c == null,'danger','success')} form-control text-right " id="totaldomestic"
                                                   />
                                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                             style="float:left;margin-top:11px;margin-left:4px;"
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalPaymentDomesticPercent__c.inlineHelpText}" />
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                     <apex:inputfield value="{!wallet.TotalPaymentDomesticAmtPerYear__c}" styleClass="form-control text-right"
                                                   />
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalPaymentDomesticAmtPerYear__c.inlineHelpText}" />
                                                    </td>
                                                </tr>
                                                                                                                                                <tr>
                                                    <td class="text-left forceBackground" style="border: none;">
                                                        Total Payment Import        
                                                        
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                       
                                                    <apex:inputfield value="{!wallet.TotalPaymentImportPercent__c }" styleClass="form-control text-right "
                                                   />
                                                         <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalPaymentImportPercent__c.inlineHelpText}" />
                                                        
                                                    </td>
                                                    <td class="text-right" style="border: none;">
                                                      <apex:inputfield value="{!wallet.TotalPaymentImportAmtPerYear__c }" styleClass="form-control text-right "
                                                   />
                                                           <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.TotalPaymentImportAmtPerYear__c.inlineHelpText}" />
                                                    </td>
                                                </tr>
                                            </table>
                                                     
                                        </div>    
                                     </div>
                                </div>
                            </div>
                            <div>
                                <br/>
                                <table class="table table-striped table-hover">
                                    <thead>
                                    <tr>
                                        <td colspan="4">
                                                <p id="PaymentDomestic" class="bg-danger text-center" style="display:{!if(isRequiredPaymentMethod,'block','none')}; float: left;padding: 8px;border: 1px solid #E28888;">
                                                    <!--If Payment Domestic is more than 0, there must be at least one product with %Vol. of more than 0-->
                                                    {!msgPaymentDomestic}

                                                </p>
                                            </td>


                                    </tr>
                                        <tr>
                                            <td class="text-left" style="border: none;"><label
                                                        class="control-label">Unit: THB</label>
                                            </td>
                                            
                                        </tr>
                                        <tr>
                                            <th rowspan="2" style="vertical-align: middle;width:230px;">Payment Method<br />(Domestic)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.Label__c.inlineHelpText}" />

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">No. of transactions<br />(Average per Month)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.NoOfTransaction__c.inlineHelpText}" />

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Domestic (Vol.)<br />(Average per Month)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.Volume__c.inlineHelpText}" />

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">% Vol.
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.VolumePercent__c.inlineHelpText}" />

                                            </th>
                                            <th colspan="5" style="vertical-align: middle;">%TMB Share vs %Other Banks share</th>
                                            <th rowspan="2" style="vertical-align: middle;">Average<br />provident<br />fund (%)
                                               <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.AvgProvidentFund__c.inlineHelpText}" />

                                                                                                                              </th>
                                            <th rowspan="2" style="vertical-align: middle;">Standard Fee<br />(Reference)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.StandardFee__c.inlineHelpText}" />

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Fee charge <br />(adjusted by RM)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.FeeCharge__c.inlineHelpText}" />

                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Wallet Cash<br />fee (Yearly)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.WalletFee__c.inlineHelpText}" />

                                            </th>
                                        </tr>
                                        <tr>
                                            <th style="padding: 15px;">%Share-<br />TMB
                                            <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.SharedTMB__c.inlineHelpText}" />

                                            </th>
                                            <th style="padding: 15px;">%Share -
                                                <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.SharedBank1__c.inlineHelpText}" />

                                                <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankPaymentDomestic.SharedBank1__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>  
                                                <th  style="padding: 15px;">%Share -
                                                    <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.SharedBank2__c.inlineHelpText}" />

                                                    <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankPaymentDomestic.SharedBank2__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                                <th  style="padding: 15px;">%Share -
                                                     <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.SharedBank3__c.inlineHelpText}" />

                                                    <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankPaymentDomestic.SharedBank3__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                               <th  style="padding: 15px;">%Share -
                                                    <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentDomestic__c.Fields.SharedBank4__c.inlineHelpText}" />

                                                   <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankPaymentDomestic.SharedBank4__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                                   <apex:repeat value="{!fdetailMap['Payment Domestic']}" var="PDdetail" >
                                                          <apex:variable value="{!fheaderMap[PDdetail.Account_Plan_Flow_Header__c]}" var="PDHeader" /> 
                                                         
                                         
                                             
                                                 <tr class="">
                                                     <td class="text-left forceBackground" >{!PDHeader.Label__c}
                                                     
                                                     </td>
                                                     
                                                     <td class="text-right">
                                               <apex:inputfield value="{!PDdetail.NoOfTransaction__c }"  styleClass=" form-control text-right fillin"
                                                       rendered="{!PDHeader.isNoTransactions__c  }"  style="width:70px;float:right;" />
                         
                                                        </td>
                                                       
                                                       
                                                       
                                                       <td class="text-right">
                                              <apex:outputfield value="{!PDdetail.Volume__c}" styleClass="form-control text-right"
                                                      style="width:70px;float:right;"
                                                      rendered="{!PDdetail.Volume__c !=null&& PDdetail.Volume__c !=0}" />
                                               </td>
                                                      
                                          <td class="text-right">
                                                <apex:outputfield value="{!PDdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                   rendered="{!
                                                   if( !PDHeader.isVolumePercent__c ,
                                                   if(PDdetail.VolumePercent__c !=null 
                                                      && PDdetail.VolumePercent__c !=0 ,true,false),false)}"   
                                                   style="width:70px;float:right;" />
                                                       
                                                <apex:inputfield value="{!PDdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!PDHeader.isVolumePercent__c}"   style="width:70px;float:right;" />

                                                
                                            </td>
                                                   
                                             <td class="text-right" >
                                               <apex:inputfield value="{!PDdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{! (PDHeader.isVolumePercent__c || PDHeader.Account_Plan_Flow_Header__c !=null)&& !PDHeader.isHide_Shared__c}"    style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!PDdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PDHeader.isVolumePercent__c && PDHeader.isHide_Shared__c ,if(PDdetail.SharedTMB__c !=null && PDdetail.SharedTMB__c !=0 ,true,false),false)}"  
                                                    style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!PDdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                   rendered="{! (PDHeader.isVolumePercent__c || PDHeader.Account_Plan_Flow_Header__c !=null)&& !PDHeader.isHide_Shared__c}"     style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!PDdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PDHeader.isVolumePercent__c && PDHeader.isHide_Shared__c,if(PDdetail.SharedBank1__c !=null && PDdetail.SharedBank1__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                <apex:inputfield value="{!PDdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{! (PDHeader.isVolumePercent__c || PDHeader.Account_Plan_Flow_Header__c !=null)&& !PDHeader.isHide_Shared__c}"     style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!PDdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PDHeader.isVolumePercent__c && PDHeader.isHide_Shared__c,if(PDdetail.SharedBank2__c !=null && PDdetail.SharedBank2__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>        
                                             <td class="text-right" >
                                                 <apex:inputfield value="{!PDdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{! (PDHeader.isVolumePercent__c || PDHeader.Account_Plan_Flow_Header__c !=null)&& !PDHeader.isHide_Shared__c}"     style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!PDdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PDHeader.isVolumePercent__c && PDHeader.isHide_Shared__c,if(PDdetail.SharedBank3__c !=null && PDdetail.SharedBank3__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>    
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!PDdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{! (PDHeader.isVolumePercent__c || PDHeader.Account_Plan_Flow_Header__c !=null)&& !PDHeader.isHide_Shared__c}"     style="width:70px;float:right;" />
                                                 <apex:outputfield value="{!PDdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PDHeader.isVolumePercent__c && PDHeader.isHide_Shared__c ,if(PDdetail.SharedBank4__c !=null && PDdetail.SharedBank4__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>        
                                             <td class="text-right">
                                                        <apex:inputfield value="{!PDdetail.AvgProvidentFund__c}" styleClass="form-control text-right fillin"
                                                        style="display: {! If(PDHeader.isProvidentfund__c,'grid','none' ) };" 
                                                        />
                                               </td>       
                                            
                                                     
                                              <td class="text-right {!if(PDdetail.StandardFee__c !=null && PDdetail.StandardFee__c != 0,'forceBackground','')}">
                                               <apex:outputfield value="{!PDdetail.StandardFee__c}"
                                                    rendered="{!if(
                                                    PDdetail.StandardFee__c !=null 
                                                    && PDdetail.StandardFee__c != 0 
                                                    && PDHeader.isFreeCharge__c 
                                                    && PDHeader.Fee_Charge_Type__c =='Percent'
                                                    ,'true','false')}"
                                                />
                                                        
                                                        <apex:outputtext value="{0, number, ###,##0.00}"
                                                        
                                                        rendered="{!if(
                                                        PDHeader.isFreeCharge__c 
                                                        && PDdetail.StandardFee__c !=null 
                                                        && PDdetail.StandardFee__c != 0
                                                        && PDHeader.Fee_Charge_Type__c =='Number'
                                                        ,'true','false')}" >
                                                                        <apex:param value="{!PDdetail.StandardFee__c}" />
                                                         </apex:outputtext>
                                                </td> 
                                                                        
                                                <td class="text-right">
                                                 <apex:inputfield value="{!PDdetail.FeeCharge__c}" 
                                                 styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(PDHeader.isFreeCharge__c,'block','none') };" />
                                                        
                                                       
                                                </td> 
                                                    
                                                     <td class="text-right">
                                                     
                                                <apex:outputfield value="{!PDdetail.CD_WalletFee__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!PDdetail.Account_Plan_Flow_Header__r.isFreeCharge__c
                                                    && PDdetail.ID !=null
                                                    && if( PDdetail.CD_WalletFee__c !=null,true,false) 

                                                     }"   
                                                    style="width:70px;float:right;" />
                                                     
                                                <!-- /******************** BAU Issue 00005057 2017-02-27 ********************/
                                                <apex:outputfield value="{!PDdetail.CD_WalletFee__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!PDdetail.Account_Plan_Flow_Header__r.isFreeCharge__c
                                                    && PDdetail.ID !=null
                                                    && if( PDdetail.CD_WalletFee__c !=null,if(PDdetail.CD_WalletFee__c>0,true,false ),false) 

                                                     }"   
                                                    style="width:70px;float:right;" />
                                                /******************** BAU Issue 00005057 2017-02-27 ********************/ -->


                                                     <apex:outputtext value="{0, number, ###,##0}"
                                                        
                                                         rendered="{! PDdetail.ID ==null && PDHeader.isFreeCharge__c
                                                         && legacyWalletFeeMap[PDHeader.id] >0 }" >
                                                                        <apex:param value="{!legacyWalletFeeMap[PDHeader.id]}" />
                                                         </apex:outputtext>



                                            
                                                </td>
                                                     
                                                     
                                                     </tr>
                                            
                                       </apex:repeat>
                                       <tr class="info endRow">
                                            <td class="forceBackground">Total</td>
                                            <td> </td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentDomesticAvgPerMonth__c}"  styleClass="form-control text-right" />
                                                </td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentDomesticVolPercent__c}"  styleClass="form-control text-right" />%
                                                </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"> </td>
                                            
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td class="text-right"> </td>
                                            <td class="text-right"></td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentDomesticWalletCashFee__c}"  styleClass="form-control text-right fillin" />
                                                </td>
                                        </tr>      
                                    </tbody>
                                </table>
                            </div>                                                    
                            
                            <!-- Start >> 17Aug2015 :by DA -->
                            <br /><br /> 
                            <div>
                                <table class="table table-striped table-hover" style="width:50%;" id="domesticpaymenttable">                                   
                                    <thead>
                                        <tr >
                                            <th colspan="2">Domestic payment method</th>
                                                                                           
                                            <th style="width:150px;">Business Opportunity</th>
                                        </tr>
                                       <apex:variable var="rowNum" value="{!1}" />     
                                       <apex:repeat value="{!DomesticPaymentSegment}" var="key" >
                                             
                                             <tr >
                                            <th class="text-left">{!key}</th>
                                            <th></th>                                               
                                            <th></th>
                                        </tr>
                                        <apex:repeat value="{!QuestionnaireMap[key]}" var="qm" >
                                                 <tr  id="tr{!rowNum}">
                                                
                                                <td class="forceBackground text-left" >{!qm.Question__c}
                                                <br />
                                                {!qm.Question_TH__c}
                                                </td>
                                                <td style="width:200px;" >
                                              <apex:inputField value="{!qm.Answer__c}" rendered="{!if(qm.Answer_Type__c =='Yes or No','true','false')}" 
                                              styleClass=" form-control fillin Answer{!rowNum}" style="height:30px;"  
                                              onchange="showOpportunity(this,{!rowNum},'domesticpaymenttable');"  />
                                                  
                                                  <apex:inputField value="{!qm.OptionText__c}" rendered="{!if(qm.Answer_Type__c =='Text','true','false')}" 
                                              styleClass=" form-control fillin Answer{!rowNum}" style="height:30px;"  
                                              onchange="showOpportunity(this,{!rowNum},'domesticpaymenttable');" />
                                                  <apex:inputField value="{!qm.OptionNumber__c}" rendered="{!if(qm.Answer_Type__c =='Number','true','false')}" 
                                              styleClass=" form-control fillin Answer{!rowNum}" style="height:30px;"  
                                              onchange="showOpportunity(this,{!rowNum},'domesticpaymenttable');" />
                                                  <apex:inputField value="{!qm.OptionPercent__c}" rendered="{!if(qm.Answer_Type__c =='Percent','true','false')}" 
                                              styleClass=" form-control fillin Answer{!rowNum}" style="height:30px;"  
                                              onchange="showOpportunity(this,{!rowNum},'domesticpaymenttable');" />
                                                  <apex:inputField value="{!qm.OptionBank__c}" rendered="{!if(qm.Answer_Type__c =='Bank','true','false')}" 
                                              styleClass="  fillin Answer{!rowNum}" style="height:30px;border-radius: 4px;" />
                                                </td>
                                              <td style="width: 150px;"  id="Oppty{!rowNum}"
                                              class="text-left {!IF(qm.Answer__c == 'Yes','','display-none')}">
                                                  
                                                  {!qm.Opportunity__c}
                                              </td>
                                            </tr>
                                          <apex:variable var="rowNum" value="{!rowNum + 1}" />        
                                                     </apex:repeat>
                                                 </apex:repeat> 
                                            
                                    </thead>                                    
                                </table>
                            </div>                            
                            <!-- End >> 17Aug2015 :by DA -->
                            
                            <div style="overflow-x: scroll;">
                                <br />
                                <table class="table table-striped table-hover">
                                    <thead>
                                    <tr>
                                        
                                         <td colspan="6">
                                                <p id="PaymentImport" class="bg-danger text-center" style="display:{!if(isRequiredPaymentImport,'block','none')}; float: left;padding: 8px;border: 1px solid #E28888;">
                                                    <!--If Payment Import is more than 0, there must be at least one product with %Vol. of more than 0-->
                                                    {!msgPaymentImport}

                                                </p>
                                            </td>

                                    </tr>
                                        <tr>
                                            <td class="text-left" style="border: none;"><label
                                                        class="control-label">Unit: THB</label>
                                            </td>
                                           
                                        </tr>
                                        <tr>
                                            <th rowspan="2" style="vertical-align: middle;">Payment Method<br /> (Import)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.Label__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="3" style="vertical-align: middle;">Term<br />(Days)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.Term__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="3" style="vertical-align: middle;">Payment pattern
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.Pattern__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">No. of<br />transactions<br /> Average<br />per Month
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.NoOfTransaction__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">Import
                                                (Vol.)<br /> Average<br />per Month
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.Volume__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="2" style="vertical-align: middle;">% Vol.
                                            <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.VolumePercent__c.inlineHelpText}" />
                               
                                            </th>
                                            <th colspan="5">%TMB Share vs %Other Banks share</th>
                                            <th rowspan="2" style="vertical-align: middle;">Type of Fee
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.Type_of_Fee__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="2" style="vertical-align:middle;">Standard Fee<br />(Reference)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.StandardFee__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="2" style="vertical-align:middle;">Fee charge<br/>(adjusted by RM)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.FeeCharge__c.inlineHelpText}" />
                               
                                            </th>
                                            <th rowspan="2" style="vertical-align:middle;">Wallet TF Fee<br />(Yearly)
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.WalletTFFee__c.inlineHelpText}" />
                               
                                            </th>
                                        </tr>
                                        <tr>
                                            <th style="padding: 15px;">%Share-<br /> TMB
                                             <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.SharedTMB__c.inlineHelpText}" />
                                            </th>
                                            <th style="padding: 15px;">%Share -
                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.SharedBank1__c.inlineHelpText}" />
                                                <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankPaymentImport.SharedBank1__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>  
                                                <th  style="padding: 15px;">%Share -
                                                    <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.SharedBank2__c.inlineHelpText}" />
                                                    <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1" 
                                                        value="{!otherBankPaymentImport.SharedBank2__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                                <th  style="padding: 15px;">%Share -
                                                    <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.SharedBank3__c.inlineHelpText}" />
                                                    <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankPaymentImport.SharedBank3__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                               <th  style="padding: 15px;">%Share -
                                                   <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanPaymentImport__c.Fields.SharedBank4__c.inlineHelpText}" />
                                                   <br />
                                                    <apex:selectlist styleclass="form-control fillin-input90" size="1"
                                                        value="{!otherBankPaymentImport.SharedBank4__c}" multiselect="false">
                                                        <apex:selectOptions value="{!shareBanks}" />
                                                    </apex:selectlist>
                                                </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        
                                                   <apex:repeat value="{!fdetailMap['Payment Import']}" var="PIdetail" >
                                                          <apex:variable value="{!fheaderMap[PIdetail.Account_Plan_Flow_Header__c]}" var="PIheader" /> 
                                                         
                                     
                                         
                                             
                                                 <tr class="">
                                                     <td class="text-left {! if(PIheader.IsHideRow__c,'','forceBackground')} " >
                                                     <span style="display:{! if(PIheader.IsHideRow__c,'none','grid')};"

                                                     >{!PIheader.Label__c}</span>
                                                     
                                                     </td>
                                                     
                                                     <td class="text-right">
                                               <apex:inputfield value="{!PIdetail.TermDays__c  }"  styleClass=" form-control text-right fillin"
                                                         style="width:70px;float:right;display:{!if(PIheader.isTerm__c,'block','none')};" />
                         
                                                        </td>
                                                       <td>
                                                        <apex:inputfield value="{!PIdetail.Pattern__c }"  styleClass=" form-control text-right fillin" 
                                                      style="min-width: 120px;display:{!if(!PIheader.IsHideRow__c,'block','none')};" />
                         
                                                        </td>
                                                      <td class="text-center">
                                                            <apex:inputfield value="{!PIdetail.NoOfTransaction__c}" styleClass="form-control text-right fillin" 
                                                            style="width:70px;display:{!if(PIheader.isNoTransactions__c && !PIheader.IsHideRow__c,'block','none')};"
                                                            />

                                                            <apex:outputField value="{!PIdetail.NoOfTransaction__c}" styleClass="form-control text-right fillin" style="width:70px;"
                                                            rendered="{! 
                                                            if(PIdetail.NoOfTransaction__c !=null,
                                                            if(PIdetail.NoOfTransaction__c >0,true,false)
                                                            ,false)

                                                             &&
                                                            !PIheader.isNoTransactions__c && 
                                                            !PIheader.IsHideRow__c }" 
                                                            />




                                                                </td>
                                                       
                                                       
                                                       <td class="text-right">
                                              <apex:outputfield value="{!PIdetail.Volume__c}" styleClass="form-control text-right"
                                                      style="width:70px;float:right;"
                                                      rendered="{!PIdetail.Volume__c !=null&& PIdetail.Volume__c !=0&&  !PIheader.IsHideRow__c}" />
                                               </td>
                                                      
                                          <td class="text-right">
                                                <apex:outputfield value="{!PIdetail.VolumePercent__c}" styleClass="form-control text-right fillin"
                                                   rendered="{!
                                                   if( !PIheader.isVolumePercent__c ,
                                                   if(PIdetail.VolumePercent__c !=null 
                                                      && PIdetail.VolumePercent__c !=0 ,true,false),false)}"   
                                                   style="width:70px;float:right;" />
                                                       
                                                <apex:inputfield value="{!PIdetail.VolumePercent__c}" styleClass="form-control text-right fillin"

                                                     style="width:70px;float:right;display:{!if(PIheader.isVolumePercent__c,'block','none')};" />

                                                
                                            </td>
                                                   
                                             <td class="text-right" >
                                               <apex:inputfield value="{!PIdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(PIheader.isVolumePercent__c,'block','none')};" 
                                                    />
                                                 <apex:outputfield value="{!PIdetail.SharedTMB__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PIheader.isVolumePercent__c,if(PIdetail.SharedTMB__c !=null && PIdetail.SharedTMB__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!PIdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                     style="width:70px;float:right;display:{!if(PIheader.isVolumePercent__c,'block','none')};" />
                                                 <apex:outputfield value="{!PIdetail.SharedBank1__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PIheader.isVolumePercent__c,if(PIdetail.SharedTMB__c !=null && PIdetail.SharedBank1__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>
                                            <td class="text-right" >
                                                <apex:inputfield value="{!PIdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(PIheader.isVolumePercent__c,'block','none')};" />
                                                 <apex:outputfield value="{!PIdetail.SharedBank2__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PIheader.isVolumePercent__c,if(PIdetail.SharedTMB__c !=null && PIdetail.SharedBank2__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>        
                                             <td class="text-right" >
                                                 <apex:inputfield value="{!PIdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(PIheader.isVolumePercent__c,'block','none')};" />
                                                 <apex:outputfield value="{!PIdetail.SharedBank3__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PIheader.isVolumePercent__c,if(PIdetail.SharedTMB__c !=null && PIdetail.SharedBank3__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                            </td>    
                                            <td class="text-right" >
                                                 <apex:inputfield value="{!PIdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(PIheader.isVolumePercent__c,'block','none')};"

                                                     />
                                                 <apex:outputfield value="{!PIdetail.SharedBank4__c}" styleClass="form-control text-right fillin"
                                                    rendered="{!if(!PIheader.isVolumePercent__c,if(PIdetail.SharedTMB__c !=null && PIdetail.SharedBank4__c !=0 ,true,false),false)}"  style="width:70px;float:right;" />      
                          
                                                
                                            </td>        
                                             <td class="text-right">
                                                        <apex:outputfield value="{!PIheader.Type_of_Fee__c }" styleClass="form-control text-right fillin"
                                                        rendered="{!PIheader.Type_of_Fee__c  !=null }" 
                                                        />
                                               </td>       
                                            
                                                     
                                              <td class="text-right {!if(PIdetail.StandardFee__c !=null && PIdetail.StandardFee__c != 0,'forceBackground','')}">
                                               <apex:outputfield value="{!PIdetail.StandardFee__c}"
                                                    rendered="{!if(
                                                    PIdetail.StandardFee__c !=null 
                                                    && PIdetail.StandardFee__c != 0 
                                                    && PIheader.isFreeCharge__c 
                                                    && PIheader.Fee_Charge_Type__c =='Percent'
                                                    ,'true','false')}"
                                                />
                                                        
                                                        <apex:outputtext value="{0, number, ###,##0.00}"
                                                        
                                                        rendered="{!if(
                                                        PIheader.isFreeCharge__c 
                                                        && PIdetail.StandardFee__c !=null 
                                                        && PIdetail.StandardFee__c != 0
                                                        && PIheader.Fee_Charge_Type__c =='Number'
                                                        ,'true','false')}" >
                                                                        <apex:param value="{!PIdetail.StandardFee__c}" />
                                                         </apex:outputtext>
                                                </td> 
                                                                        
                                                <td class="text-right">
                                                 <apex:inputfield value="{!PIdetail.FeeCharge__c}" 
                                                 styleClass="form-control text-right fillin"
                                                    style="width:70px;float:right;display:{!if(PIheader.isFreeCharge__c,'block','none')};" />
                                                        
                                                       
                                                </td> 
                                                    
                                                     <td class="text-right">
                                                <apex:outputfield value="{!PIdetail.CD_WalletFee__c }" styleClass="form-control text-right fillin"
                                                    rendered="{!PIdetail.Account_Plan_Flow_Header__r.isFreeCharge__c && PIdetail.id !=null 
                                                    && if( PIdetail.CD_WalletFee__c !=null,true,false)  }"   
                                                    style="width:70px;float:right;" />
                                                     
                                                <!-- /******************** BAU Issue 00005057 2017-02-27 ********************/
                                                <apex:outputfield value="{!PIdetail.CD_WalletFee__c }" styleClass="form-control text-right fillin"
                                                    rendered="{!PIdetail.Account_Plan_Flow_Header__r.isFreeCharge__c && PIdetail.id !=null 
                                                    && if( PIdetail.CD_WalletFee__c !=null,if(PIdetail.CD_WalletFee__c>0,true,false ),false)  }"   
                                                    style="width:70px;float:right;" />
                                                /******************** BAU Issue 00005057 2017-02-27 ********************/ -->

                                                     <apex:outputtext value="{0, number, ###,##0}"
                                                        
                                                         rendered="{! PIdetail.ID ==null && PIheader.isFreeCharge__c
                                                         && legacyWalletFeeMap[PIheader.id] >0 }" >
                                                                        <apex:param value="{!legacyWalletFeeMap[PIheader.id]}" />
                                                         </apex:outputtext>

                                            
                                                </td>
                                                     
                                                     
                                                     </tr>
                                            
                                       </apex:repeat>
                                      <tr class="info endRow">
                                            <td class=" forceBackground">Total</td>                                            
                                            <td> </td>
                                            <td class="text-left"></td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentImportNoOfTransaction__c}" styleClass="form-control text-right fillin" />
                                            </td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentImportImportVol__c}" styleClass="form-control text-right fillin" />
                                            </td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentImportVolPercent__c} " styleClass="form-control text-right fillin" />%
                                            
                                            </td>
                                            <td class="text-right"> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>                                            
                                            <td> </td>
                                            <td> </td>
                                            <td> </td>
                                            <td class="text-right">
                                                <apex:outputfield value="{!wallet.SumOfPaymentImportWalletTFFee__c}" styleClass="form-control text-right fillin" />
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        
                            <div>
                                <br />
                                <table class="table table-striped table-hover" style="width: 50%">
                                    <thead>
                                    <apex:variable var="paymentimport" value="Payment Method Import" /> 
                                    <apex:variable var="internetbankingPayment" value="" /> 
                                     <apex:repeat value="{!QuestionnaireMap[paymentimport]}" var="qnm" >
                                         
                                        <apex:variable var="internetbankingPayment" value="{!qnm.Answer__c}" rendered="{!IF(qnm.Answer__c == 'Yes' && qnm.SEQ__c == 1,true,false)}"/>
         
                                        <tr style="display:{!IF(internetbankingPayment == 'Yes' || qnm.SEQ__c == 1,'table-row','none')};" class="{!IF(qnm.SEQ__c != 1,'internetbankingPayment','')}">
                                            <td class="forceBackground text-left" style="width:120px;">
                                                <apex:inputfield value="{!qnm.Answer__c}" styleClass="form-control fillin"
                                                style="width:120px;" onchange="internetbanking('{!qnm.SEQ__c}',this,'Payment')"/>
                                                    </td>
                                                <td class="forceBackground text-left" >
                                                    {!qnm.Question__c}
                                                <br />
                                                    {!qnm.Question_TH__c}
                                                </td>
                                        </tr>
                                                 
                                        </apex:repeat>
                                    </thead>
                                </table>
                                
                            </div>
                        
                           <div>
                                <br />
                                               <div class="row" style="padding-bottom: 3px;"> 
                                        <div class="col-sm-12 col-md-6 col-lg-6" style="width:40%;">      
                                              <a href="#" class="btn  btn-success" data-toggle="collapse" aria-expanded="true" id="paymentUI">Add / Edit Payment Currency</a>  
                                              <apex:outputpanel id="PaymentCurrencypanel" >
                                              <div  style="float:right;margin-right:50px;display:{!if(isPaymentCurrencyNull,'block','none')};"> 
                                                    <p class='bg-danger text-center' style=' float: left;padding: 8px;border: 1px solid #E28888;margin-left:10px;margin-top: 20px;font-size:15px;'>
                                                       <!--If Payment Import is more than 0, there must be at least one record of Payment Currency-->
                                                       {!msgPaymentCurrency}
                                                    </p>
                                                    
                                                </div>
                                              </apex:outputpanel>
                                        </div>                                       
                                    </div> 
                                              <br />
                                              <apex:outputpanel id="paymentblock">
                                <table class="table table-striped table-hover"
                                    style="width: 50%">
                                    <thead>
                                        
                                        <tr>
                                            <th>Payment Currency
                                              <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                      title="{!$ObjectType.AcctPlanCollectionOrPaymentCurrency__c.Fields.CCY__c.inlineHelpText}"  />
            
                                            </th>
                                            <th>Portion (%)
                                                           <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionOrPaymentCurrency__c.Fields.PaymentPortion__c.inlineHelpText}"  />
            
                                                         </th>
                                            <th class="text-right">Amount per year (THB)
                                                       <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanCollectionOrPaymentCurrency__c.Fields.PaymentAmtPerYear__c.inlineHelpText}"  />
            
                                                     </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <apex:variable var="totalPaymentCCY" value="{!0}" />     
                                        <apex:variable var="totalPaymentAmt" value="{!0}" />
                                          
                                        <apex:repeat value="{!PaymentList}" var="pl" >               
                                         <tr>
                                            <td>
                                                <apex:outputtext value="{!pl.CCY__r.ShortName__c}" />
                                            </td>
                                            <td class="text-center">
                                            <apex:outputfield value="{!pl.PaymentPortion__c}" />
                                            </td>
                                            <td class="text-right">
                                            <apex:outputfield value="{!pl.PaymentAmtPerYear__c}" /> 
                                            </td>
                                        </tr>
                                                <apex:variable var="totalPaymentCCY" value="{!totalPaymentCCY + pl.PaymentPortion__c}" />
                                                <apex:variable var="totalPaymentAmt" value="{!totalPaymentAmt + pl.PaymentAmtPerYear__c}" />
                                            </apex:repeat>        
                                            <tr class="info endRow">
                                                <td class="text-center">Total</td>
                                                <td class="text-center"><apex:outputText value="{!totalPaymentCCY}"/>%</td>
                                                <td class="text-right">
                                                    <apex:outputText value="{0, number, ###,##0}">
                                                        <apex:param value="{!totalPaymentAmt}" />
                                                    </apex:outputText>
                                                </td>
                                            </tr>                                        
                                    </tbody>
                                </table>
                                            </apex:outputpanel>
                            </div>
                               
                            <!-- Start >> 17Aug2015 :by DA -->
                            <div>
                                <br />
                                <div class="row">
                                <div class="col-lg-8 col-md-12 col-sm-12">
                                    <table class="table table-striped table-hover" id="liquidityTable">
                                        <thead>
                                            <tr>
                                                <th colspan="2">Liquidity Management</th>                                                
                                                <th style="width:150px;">Business Opportunity</th>
                                            </tr>
                                      </thead>
                                      <tbody>
                                            <apex:variable var="rowNum" value="{!1}" />   
                                            <apex:variable var="paymentimport" value="Liquidity Management" /> 
                                     <apex:repeat value="{!QuestionnaireMap[paymentimport]}" var="qm" >
                                                <tr >
                                                <td style="width:120px;" >
                                              <apex:inputField value="{!qm.Answer__c}" 
                                              styleClass=" form-control fillin" style="height:30px;" onchange="showOpportunity(this,{!rowNum},'liquidityTable');" />
                                                </td>
                                                <td class="forceBackground text-left" >{!qm.Question__c}
                                                <br />
                                                {!qm.Question_TH__c}
                                                </td>
                                              <td style="width: 150px;"  id="Oppty{!rowNum}"
                                              class="text-left {!IF(qm.Answer__c == 'Yes','','display-none')}">
                                                  {!qm.Opportunity__c}
                                              </td>
                                            </tr>
                                            <apex:variable var="rowNum" value="{!rowNum + 1}" />      
                                        </apex:repeat>
                                            
                                         
                                        
                                      </tbody>
                                  </table>
                                </div>
                                </div>
                            </div>
                            <!-- End >> 17Aug2015 :by DA -->
                            
                            <div>
                                <br />
                                <div class="col-lg-3 col-md-12 col-sm-12">
                                    <table class="table table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>Total Wallet Cash fee (yearly)
                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.SumOfWalletCashFee__c.inlineHelpText}" />
                                        
                                                </th>
                                                <td style="text-align:right"> <apex:outputfield value="{!wallet.SumOfWalletCashFee__c }" /></td>
                                            </tr>
                                            <tr>
                                                <th>Total Wallet TF fee (yearly)
                                                 <span class="glyphicon glyphicon-question-sign" id="bootstrap-tooltip" 
                                                     data-toggle="tooltip"
                                                     data-delay='{"show":"0", "hide":"100"}'
                                                     data-animation="false"
                                                     data-placement="bottom" 
                                                     title="{!$ObjectType.AcctPlanWallet__c.Fields.SumOfWalletTFFee__c.inlineHelpText}" />
                                        
                                                </th>
                                                <td style="text-align:right"><apex:outputfield value="{!wallet.SumOfWalletTFFee__c }" /></td>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                                
                            </div>
                    
                        
                        </fieldset>
                </div> 
                </div>

                <br / >

                 <!-- Start Section 3 -->
                        <header class="navbar navbar-default navbar-branded" role="banner">
                            <div class="panel-heading">
                                <div class="navbar-header ">
                                    <a data-toggle="collapse" aria-expanded="true" href="#collapse3"
                                    class="navbar-brand navbar-foundation-logo">Agents &amp; Securities Services</a>
                                </div>
                            </div>
                        </header>
                        <div class="card collapse in panel-collapse" id="collapse3">
                            <div class="card-detail">
                                <fieldset>
                                <!--<div class="col-sm-12 " style="width: 40%">
                                        <div class="form-group">
                                <div>
                                            <table class="table table-striped">
                                                                                  
                                        <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;">AUM (Asset Under Management) :
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.Asset_Under_Management__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:inputfield onchange="checkIshasValue(this,'');"
                                                value="{!acctplanwallet.Asset_Under_Management__c}" 
                                                styleClass="{!IF(acctplanwallet.Asset_Under_Management__c == null || acctplanwallet.Asset_Under_Management__c <=0 ,'danger','success')}  text-right form-control "/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left forceBackground" style="border: none;">
                                                <label class="control-label">AS Fee (%)
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.AS_Fee__c .inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="text-right" style="border: none;">
                                                <apex:inputfield onchange="checkIshasValue(this,'');"
                                                                                     value="{!acctplanwallet.AS_Fee__c }" 
                                                                                     styleClass="{!IF(acctplanwallet.AS_Fee__c == null || acctplanwallet.AS_Fee__c <=0 ,'danger','success')}  text-right form-control" />
                                            </td>
                                        </tr>
                                       <tr>
                                            <td class="text-left forceBackground" style="border: none;">
                                                <label class="control-label">AS Fee (Investment Fund)
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.AS_Fee_AUM__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="text-right" style="border: none;">
                                                <apex:outputfield value="{!acctplanwallet.AS_Fee_AUM__c }" styleClass="form-control" />
                                            </td>
                                        </tr>       
                                    </table>
                                            </div>
                                                </div>
                                                </div>
                                        <br/><br/>-->
 
                                        <!-- AS Fee Section -->
                                       <div class="col-sm-12 " >
                                        <div class="form-group">
 
                                            <div>
                                             <table class="table table-striped" id="ASFeeTable" style="width: 80%">
                                    <thead>
                                        <tr>
                                            <th style="border:none;background-color:white;text-align: left;">
                                                <button id="AsFeeIU" class="btn btn-success">Add / Edit</button>
                                            </th>   
                                        </tr>
                                        <tr>
                                            <th style="vertical-align: top;">
                                                AS Product/Service
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                                    data-animation="false" data-placement="bottom" 
                                                                    title="{!$ObjectType.Account_Plan_AS_Fee__c.Fields.AS_Product_Service__c.inlineHelpText}" />
                                                
                                            </th> 
                                            <th style="vertical-align: top;">
                                                Type of Fee
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                                    data-animation="false" data-placement="bottom" 
                                                                    title="{!$ObjectType.Account_Plan_AS_Fee__c.Fields.Type_of_Fee__c.inlineHelpText}" />
                                                
                                            </th>
                                            <th style="vertical-align: top;">
                                                Net Asset Value (NAV) (THB)
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                                    data-animation="false" data-placement="bottom" 
                                                                    title="{!$ObjectType.Account_Plan_AS_Fee__c.Fields.Net_Asset_Value__c.inlineHelpText}" />
                                            </th>                      
                                           <th style="vertical-align: top;">
                                                AS Fee (%)
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                                    data-animation="false" data-placement="bottom" 
                                                                    title="{!$ObjectType.Account_Plan_AS_Fee__c.Fields.AS_Fee__c.inlineHelpText}" />
                                            </th>   
                                            <th style="vertical-align: top;">
                                                Fixed AS Fee
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                                    data-animation="false" data-placement="bottom" 
                                                                    title="{!$ObjectType.Account_Plan_AS_Fee__c.Fields.Fixed_AS_Fee__c.inlineHelpText}" />
                                            </th> 
                                            <th style="vertical-align: top;">
                                                Wallet AS Fee
                                                <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                                    data-animation="false" data-placement="bottom" 
                                                                    title="{!$ObjectType.Account_Plan_AS_Fee__c.Fields.Wallet_AS_Fee__c.inlineHelpText}" />
                                            </th>                      
                                        </tr>      
                                        
                                    </thead>
                                    <tbody>
                                                                                    
                                                                                  
                                    </tbody>
                                    
                                </table>
 
            
 
                                            </div>
                                        </div>
                                    </div>
                                             
 
                                             <div class="col-sm-12 " style="width: 40%">
                                        <div class="form-group">
                                <div>
                                    <table class="table table-striped">
                                        <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;">Wallet AS Fee - Custodian :
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.WalletASFee_Custodian__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:outputfield value="{!wallet.WalletASFee_Custodian__c}" 
                                                styleClass="text-right form-control "/>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;"> Wallet AS Fee - Fund Supervisory :
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.WalletASFee_FundSupervisory__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:outputfield value="{!wallet.WalletASFee_FundSupervisory__c}" 
                                                styleClass="text-right form-control "/>
                                            </td>
                                        </tr>
                                        
                                    <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;">Wallet AS Fee - Middle Office :
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.WalletASFee_MiddleOffice__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:outputfield value="{!wallet.WalletASFee_MiddleOffice__c}" 
                                                styleClass="text-right form-control "/>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;">Wallet AS Fee - Agency Service :
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.WalletASFee_AgencyService__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:outputfield value="{!wallet.WalletASFee_AgencyService__c}" 
                                                styleClass="text-right form-control "/>
                                            </td>
                                        </tr>
                                        
                                        <!-- End Product -->                                          
                                        <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;">Wallet AS Fee -  Registrar &amp; Payment Agent:
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.WalletASFee_RegistrarPaymentAgent__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:outputfield value="{!wallet.WalletASFee_RegistrarPaymentAgent__c}" 
                                                styleClass="text-right form-control "/>
                                            </td>
                                        </tr>
                                        <tr><td> </td></tr>
                                        <tr>
                                            <td class="padding15 text-left forceBackground" style="border: none; width: 60%;">
                                                <label class="control-label"  style="padding-top: 0;">Total Wallet AS Fee :
                                                   <span class="glyphicon glyphicon-question-sign" data-toggle="tooltip" data-delay='{"show":"0", "hide":"100"}'
                                                    data-animation="false" data-placement="bottom" 
                                                    title="{!$ObjectType.AcctPlanWallet__c.Fields.SumOfWalletASFee__c.inlineHelpText}" /> 
                                                </label>
                                            </td>                                                    
                                            <td class="padding15 text-right" style="border: none;">
                                                <apex:outputfield value="{!wallet.SumOfWalletASFee__c}" 
                                                styleClass="text-right form-control "/>
                                            </td>
                                        </tr>
                                        
                                    </table>
                                    </div>
                                    </div>
                                    </div>  
                                </fieldset>       
                            </div>
                       </div>                 
                     <!-- End Section 3 -->
              </apex:pageBlock>                              
            </apex:form>
        </div>
            <div class="bootstrap-sf1">                                  
          <!-- Modal -->
                <div  class="modal fade modal-fullscreen force-fullscreen"  id="frmModel" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="margin-bottom: 30px;margin-top: 45px;">
                  <div class="modal-dialog" style="width:100%;height:95%;" >
                    <div class="modal-content" style="width:100%;height:95%;" >
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
                        <h4 class="modal-title" id="myModalLabel"> </h4>
                      </div>
                      <div class="modal-body">
                          <iframe id="modalIframe" src="#" width="100%" height="600px" frameborder="0" allowtransparency="true"></iframe>  
                      </div>
                      <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>                       
                      </div>
                    </div>
                    <!-- /.modal-content -->
                  </div>  <!-- /.modal-dialog -->
                </div>
              </div>    

                     <apex:remoteObjects jsNamespace="JSObjects"> 
                                           
                
 
                <apex:remoteObjectModel name="Account_Plan_AS_Fee__c" fields="Id" jsShorthand="walletASFee">
                    <apex:remoteObjectField name="AS_Fee__c" jsShorthand="ASFee" /> 
                    <apex:remoteObjectField name="AS_Product_Service__c" jsShorthand="ASProductService" />
                    <apex:remoteObjectField name="Fixed_AS_Fee__c" jsShorthand="FixedASFee" />
                    <apex:remoteObjectField name="Net_Asset_Value__c" jsShorthand="NetAssetValue" />        
                    <apex:remoteObjectField name="Type_of_Fee__c" jsShorthand="TypeofFee" /> 
                    <apex:remoteObjectField name="Wallet_AS_Fee__c" jsShorthand="WalletAS_Fee" /> 
                    <apex:remoteObjectField name="SEQ__c" jsShorthand="seq" />  
                    <apex:remoteObjectField name="Account_Plan_Wallet__c" jsShorthand="wallet" />       
                                      
                </apex:remoteObjectModel>
                                           
            </apex:remoteObjects>
                    

        <apex:includescript value="{!$Resource.AccountPlan_JqueryScript}" />
        <apex:includescript value="{!$Resource.AccountPlan_Bootstrap}" />        
        <apex:includeScript value="/support/console/22.0/integration.js"/>
        <apex:includeScript value="{!$Resource.AccountPlan_Mustache}"/>
            
          <script type="text/javascript">
               // Prevent Config
               var $j = jQuery.noConflict();
               var walletid = '{!wallet.Id}'; 
                var CompanyId = '{!CompanyId}';
                var AsFeeobj = new JSObjects.walletASFee();
                             var dependsquestiontr10 = "#domesticpaymenttable .tr10";
                             var dependsquestiontr11 = "#domesticpaymenttable .tr11";
                             var dependsquestiontr12 = "#domesticpaymenttable .tr12";
                             var dependsquestiontr13 = "#domesticpaymenttable .tr13";                                
                             var dependsquestion9 = "#domesticpaymenttable .Answer9";


                 Number.prototype.formatMoney = function(c, d, t){
                    var n = this, 
                        c = isNaN(c = Math.abs(c)) ? 2 : c, 
                        d = d == undefined ? "." : d, 
                        t = t == undefined ? "," : t, 
                        s = n < 0 ? "-" : "", 
                        i = parseInt(n = Math.abs(+n || 0).toFixed(c)) + "", 
                        j = (j = i.length) > 3 ? j % 3 : 0;
                    return s + (j ? i.substr(0, j) + t : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + t) + (c ? d + Math.abs(n - i).toFixed(c).slice(2) : "");
                };
                               
                
                function showOpportunity(answer,data,table){ 
                var ids = "#"+table+" #Oppty"+data;
                 if(table !='domesticpaymenttable'){   
                      if(answer.value == 'Yes'){
                         $j(ids).show();   
                      }else{
                          $j(ids).hide();  
                      }
                 }else{
                        if(data == 4 || data==3){
                            var dependsquestion1 = "#domesticpaymenttable .Answer3";
                            var dependsquestion2 = "#domesticpaymenttable .Answer4";
                            var dependsOpp = "#domesticpaymenttable #Oppty4";
                            if($j(dependsquestion1).val()=='Yes' && $j(dependsquestion2).val()=='Yes'){
                                if($j.trim($j(dependsOpp).text())=='' || $j.trim($j(dependsOpp).text())==null){
                                    $j(dependsOpp).text('Cheque issuing');
                                    $j(dependsOpp).show();
                                    }else{
                                        $j(dependsOpp).show();
                                    }
                            }else{
                                $j(dependsOpp).hide();   
                            }
                            }else if(data == 7 || data== 8){
                             var dependsquestion3 = "#domesticpaymenttable .Answer7";
                            var dependsquestion4 = "#domesticpaymenttable .Answer8";
                                var dependsOpp2 = "#domesticpaymenttable #Oppty8";
                               
                                
                            if($j(dependsquestion3).val()!=null &&$j(dependsquestion3).val()!='' && $j(dependsquestion4).val()=='Yes'){
                                 if($j(dependsOpp2).text().trim()=='' || $j(dependsOpp2).text().trim()==null){
                                    $j(dependsOpp2).html('Payroll package, Provident fund');
                                     $j(dependsOpp2).show();
                                    }else{
                                        
                                        $j(dependsOpp2).show();
                                    }
                            }else{
                                $j(dependsOpp2).hide();   
                            }
                            
                            
                            }else if(data == 9 || data== 10 || data== 11 || data== 12 || data== 13 ){
                                   
                                
                                 var dependsquestiontr10 = "#domesticpaymenttable #tr10";
                             var dependsquestiontr11 = "#domesticpaymenttable #tr11";
                             var dependsquestiontr12 = "#domesticpaymenttable #tr12";
                             var dependsquestiontr13 = "#domesticpaymenttable #tr13";                                
                             var dependsquestion9 = "#domesticpaymenttable .Answer9";
                              var dependsquestion11 = "#domesticpaymenttable .Answer11";  
                            if($j(dependsquestion9).val()=='Yes'){
                                $j(dependsquestiontr10).show();
                                 $j(dependsquestiontr11).show();
                                $j(dependsquestiontr12).hide();
                                $j(dependsquestiontr12).val ('');
                                 $j(dependsquestiontr13).hide();
                                 $j(dependsquestiontr13).val ('');
                            }else if($j(dependsquestion9).val()=='No'){
                                
                                 $j(dependsquestiontr10).hide();
                                 $j(dependsquestiontr11).hide();
                                $j(dependsquestiontr10).val ('');
                                 $j(dependsquestiontr11).val ('');
                                
                                $j(dependsquestiontr12).show();
                                 $j(dependsquestiontr13).show();
                            }else{
                                
                                 $j(dependsquestiontr10).val ('');
                                 $j(dependsquestiontr11).val ('');
                                $j(dependsquestiontr12).val ('');
                                 $j(dependsquestiontr13).val ('');
                                
                                 $j(dependsquestiontr10).hide();
                                 $j(dependsquestiontr11).hide();
                                 $j(dependsquestiontr12).hide();
                                 $j(dependsquestiontr13).hide();
                            }
                             
                                
                                 var dependsquestion11 = "#domesticpaymenttable .Answer11";  
                                 var dependsOpp11 = "#domesticpaymenttable #Oppty11";
                            

                                if($j(dependsquestion9).val()=='Yes' && $j(dependsquestion11).val()!=null && $j(dependsquestion11).val()!=''){
                                    if($j(dependsOpp11).text().trim()=='' || $j(dependsOpp11).text().trim()==null){
                                    $j(dependsOpp11).text('Fleet Card');
                                    $j(dependsOpp11).show();
                                    }else{
                                        $j(dependsOpp11).show();
                                    }
                                  }else{
                                      $j(dependsOpp11).hide();
                                      }

                                    var dependsquestion12 = "#domesticpaymenttable .Answer12";  
                                    var dependsquestion13 = "#domesticpaymenttable .Answer13";  
                                    var dependsOpp12 = "#domesticpaymenttable #Oppty12";
                                    var dependsOpp13 = "#domesticpaymenttable #Oppty13";                                    
                                 if($j(dependsquestion9).val()=='No' && $j(dependsquestion12).val()=='Yes' && $j(dependsquestion13).val()=='Yes'){
                                     
                                    if($j(dependsOpp13).text().trim()=='' || $j(dependsOpp13).text().trim()==null){
                                            $j(dependsOpp13).text('Fleet card');
                                       
                                            $j(dependsOpp13).show();
                                            
                                    }else{
                                        $j(dependsOpp12).show();
                                        $j(dependsOpp13).show();
                                    }
                                  }else{
                                      $j(dependsOpp12).hide(); 
                                      $j(dependsOpp13).hide();
                                      }
                                  
                                
                                }else{
                                
                                 if(answer.value == 'Yes'){
                                     $j(ids).show();   
                                  }else{
                                      $j(ids).hide();  
                                  }
                            }
                     }
                 
                }
                function clearIframe(){
                    $j("#modalIframe").attr('src','');
                }

                // Ready Event  
                $j(document).ready( function () { 
                     $j('[data-toggle="tooltip"]').tooltip(); 
                    clearIframe();
                             var dependsquestiontr10 = "#domesticpaymenttable #tr10";
                             var dependsquestiontr11 = "#domesticpaymenttable #tr11";
                             var dependsquestiontr12 = "#domesticpaymenttable #tr12";
                             var dependsquestiontr13 = "#domesticpaymenttable #tr13";                                
                             var dependsquestion9 = "#domesticpaymenttable .Answer9";
                             var dependsOpp11 = "#domesticpaymenttable #Oppty11";
                            var dependsOpp12 = "#domesticpaymenttable #Oppty12";
                            var dependsOpp13 = "#domesticpaymenttable #Oppty13";
                    if($j(dependsquestion9).val()=='Yes'){
                        $j(dependsquestiontr12).addClass("display-none");
                         $j(dependsquestiontr13).addClass("display-none");
                        $j(dependsOpp11).removeClass("display-none");
                        
                    }else if($j(dependsquestion9).val()=='No'){
                        $j(dependsOpp12).removeClass("display-none");
                         $j(dependsOpp13).removeClass("display-none");
                        
                         $j(dependsquestiontr10).addClass("display-none");
                         $j(dependsquestiontr11).addClass("display-none");
                    }else{
                         $j(dependsquestiontr10).addClass("display-none");
                         $j(dependsquestiontr11).addClass("display-none");
                         $j(dependsquestiontr12).addClass("display-none");
                         $j(dependsquestiontr13).addClass("display-none");
                    }
                            
                     
                    $j('[id$=selectlgutilitiesopt]').change(function() {
               
                if($j('[id$=selectlgutilitiesopt]').val() =='Yes'){
                    
                    $j('.labellgutilitiesopt').show();
                   
                }else{
                    $j('.labellgutilitiesopt').hide();
                }
                        
                                     
            });
                    
                     $j("#CDbutton").on('click',function(event){
                        
                        event.preventDefault();
                        $j('#modalIframe').attr("src",'/apex/AccountPlanFlowEdittable?walletID={!wallet.id}&type=CD');                 
                        
                        $j('#frmModel').modal({show:true});
                    }); 
                    
                    
                    
                     $j("#collectionUI").on('click',function(event){
                        
                        event.preventDefault();
                        $j('#modalIframe').attr("src",'/apex/CurrencyEdittable?walletID={!wallet.id}&type=Collection');                 
                        
                        $j('#frmModel').modal({show:true});
                    }); 
                    
                    $j("#paymentUI").on('click',function(event){
                        
                        event.preventDefault();
                        $j('#modalIframe').attr("src",'/apex/CurrencyEdittable?walletID={!wallet.id}&type=Payment');                 
                        
                        $j('#frmModel').modal({show:true});
                    }); 
                    
                    //Close modal
                    
                    $j('#frmModel').on('hidden.bs.modal', function (e) {
                          // do something...
                                clearIframe();
                               rerendercurrency();                
                    });
                    
                    });
                function checkIshasValue(item,id) {
                    var msg = item.value;                  
                    $j(item).removeClass('info');
                    $j(item).removeClass('danger');
                    $j(item).removeClass('success');
                    if(id == 'TotalDomesticPercent' || id == 'OperatingExpAmount' || id == 'TotalPaymentDomesticPercent' || id=='COGSPercent'){
                        if(msg !='' && msg != null){
                            $j(item).addClass('success');
                        }else{
                            $j(item).addClass('danger'); 
                        }  
                    }else{
                        if(msg !='' && msg != null && msg !='0' && msg !=0){
                            $j(item).addClass('success');
                        }else{
                            $j(item).addClass('danger');
                        }     
                    }
                }  
        //Sets the title of the current tab to "Case Transactions Detail"
        window.onload = function setTitleConsole(){
            setTitle();
        }
        //Sets the title of the current tab to "Case Transactions Detail"
        function setTitle() {
            sforce.console.setTabTitle('Wallet by Domain');
        }
        function internetbanking(seq,e,section){
            var answer = e.value;    
            if(seq == 1 && answer == 'Yes'){
                if(section == 'Payment'){
                    $j('.internetbankingPayment').show();
                }else{
                    $j('.internetbankingCollection').show();
                }
            }else if(seq == 1 && answer != 'Yes'){
                if(section == 'Payment'){
                    $j('.internetbankingPayment').hide();
                }else{
                    $j('.internetbankingCollection').hide();
                }    
            }
        }


           //ASFee
              AsFeeobj.getData = function(callback){
                    AsFeeobj.retrieve({
                        
                         where: {
                            
                              Account_Plan_Wallet__c : { eq: walletid } 
                             
                          },orderby: [{SEQ__c : 'ASC'}],
                        
                        limit: 100                    
                    }
                    , function(err, records){
                            if(err) alert(err.message);
                            else {
                                 
                                                  
                                callback(records);
                            };
                        });
                }
              
                     
               // Template 
                var AsFeeTrTemplate = "<tr>" +
                                    "   <td data-id='{{Id}}' style='text-align: left;padding-left: 20px;'>{{ASProductService}}</td>"+
                                    "   <td>{{TypeofFee}}</td>"+
                                    "   <td class='text-right'>{{NetAssetValue}}</td>"+
                                    "   <td class='text-right'>{{ASFee}}</td>"+
                                    "   <td class='text-right'>{{FixedASFee}}</td>"+ 
                                    "   <td class='text-right'>{{WalletAS_Fee}}</td>"+
                                    "</tr>";    
                var AsFeeTrTotalTemplate = "<tr class='info endRow'>" +
                                    "   <td data-id='{{Id}}' class='forceBackground' colspan='2'>Total</td>"+
                                    "   <td class='forceBackground text-right' >{{NetAssetValuetotal}}</td>"+
                                    "   <td class='forceBackground text-right' >{{ASFeetotal}}</td>"+
                                    "   <td class='forceBackground text-right' >{{FixedASFeetotal}}</td>"+ 
                                    "   <td class='forceBackground text-right' >{{WalletAS_Feetotal}}</td>"+
                                    "</tr>";                                    
 
                 var AsFeetable = $j('#ASFeeTable tbody');  
 
              var AsFeeCallback =  function(result){
                          var AsFeetotal ={
                                        Id : 'ASFee-total',
                                        NetAssetValuetotal :0,
                                        ASFeetotal : 0,
                                         FixedASFeetotal :0,
                                         WalletAS_Feetotal :0
                                };
                                        /*AsFeetable.NetAssetValuetotal =  0;
                                        AsFeetable.ASFeetotal = 0;
                                        AsFeetable.FixedASFeetotal = 0;
                                        AsFeetable.WalletAS_Feetotal = 0;*/
                          for (index = 0; index < result.length; ++index) {
                            var record = result[index];
                                     var obj  = {
                                            Id : record.get("Id"),
                                            ASProductService : record.get("ASProductService"),
                                            TypeofFee  : record.get("TypeofFee"),
                                            NetAssetValue  : record.get("NetAssetValue"),
                                            ASFee  : record.get("ASFee"),
                                            FixedASFee  : record.get("FixedASFee"),
                                            WalletAS_Fee  : record.get("WalletAS_Fee")
                                        };
                                        if(obj.NetAssetValue != null){
                                            
                                            AsFeetotal.NetAssetValuetotal =  AsFeetotal.NetAssetValuetotal  + obj.NetAssetValue;
                                        }
                                        if(obj.ASFee != null){
                                            
                                            AsFeetotal.ASFeetotal = AsFeetotal.ASFeetotal + obj.ASFee;
                                        }
                                        if(obj.FixedASFee != null){
                                            
                                            AsFeetotal.FixedASFeetotal = AsFeetotal.FixedASFeetotal + obj.FixedASFee;
                                        }
                                        if(obj.WalletAS_Fee != null){
                                            
                                            AsFeetotal.WalletAS_Feetotal = AsFeetotal.WalletAS_Feetotal + obj.WalletAS_Fee;
                                        }
                                        /*AsFeetotal.NetAssetValuetotal =  AsFeetotal.NetAssetValuetotal  + obj.NetAssetValue;
                                        AsFeetotal.ASFeetotal = AsFeetotal.ASFeetotal + obj.ASFee;
                                        AsFeetotal.FixedASFeetotal = AsFeetotal.FixedASFeetotal + obj.FixedASFee;
                                        AsFeetotal.WalletAS_Feetotal = AsFeetotal.WalletAS_Feetotal + obj.WalletAS_Fee;*/
                              
                              //obj.amount = (obj.amount).formatMoney(0);
                              //obj.walletniic = (obj.walletniic).formatMoney(0); 
                                        
                                        if(obj.ASFee > 0){
                                            obj.ASFee = (obj.ASFee).formatMoney(4)+'%';
                                        }else{
                                            obj.ASFee = '';
                                        }
                                        if(obj.NetAssetValue <= 0){
                                                obj.NetAssetValue = '';
                                        }else{
                                            if( obj.NetAssetValue != null){
                                                obj.NetAssetValue = (obj.NetAssetValue).formatMoney(0);
                                            }
                                        }
                                         if(obj.FixedASFee <= 0){
                                                obj.FixedASFee = '';
                                            }else{
                                                 if( obj.FixedASFee != null){
                                                    obj.FixedASFee = (obj.FixedASFee).formatMoney(0);
                                                }
                                            }
 
                                            if(obj.WalletAS_Fee > 0 && obj.WalletAS_Fee !=null){
                                                obj.WalletAS_Fee = (obj.WalletAS_Fee).formatMoney(0);
                                            }
                                        //alert(obj.ASProductService);
                                        if(obj.ASProductService != "1) Custodian" 
                                            &&  obj.ASProductService != '2) Fund Supervisory'
                                            &&  obj.ASProductService != '3) Middle Office'
                                            &&  obj.ASProductService != '4) Agency Service'
                                            ){
 
                                            obj.ASProductService = "5) Registrar & Payment Agent";
                                        }
                                        
                                        AsFeetable.append(Mustache.render(AsFeeTrTemplate, obj));  
                     
                      } 
                  AsFeetotal.NetAssetValuetotal =  (AsFeetotal.NetAssetValuetotal).formatMoney(0);                                  
                  AsFeetotal.ASFeetotal = (AsFeetotal.ASFeetotal).formatMoney(4)+'%';
                  AsFeetotal.FixedASFeetotal = (AsFeetotal.FixedASFeetotal).formatMoney(0);
                  AsFeetotal.WalletAS_Feetotal = (AsFeetotal.WalletAS_Feetotal).formatMoney(0);
                  
                  
                   AsFeetable.append(Mustache.render(AsFeeTrTotalTemplate, AsFeetotal)); 
                    }
              //end ASFee
              
              //ASFee callback;
            AsFeeobj.getData(AsFeeCallback);
            
             $j("#AsFeeIU").on('click',function(event){
                        
                        event.preventDefault();
                        $j('#modalIframe').attr("src",'/apex/AsFeeEdittable?WalletID='+walletid+'&CompanyId='+CompanyId);                 
                        
                        $j('#frmModel').modal({show:true});
                    }); 
                    
                    $j('#frmModel').on('show.bs.modal', function () {
                        $j(this).find('.modal-body').css({                        
                            // 'max-height':'800px'
                        });
                    });
        
                    $j('#frmModel').on('hidden.bs.modal', function (e) {
                        clearIframe();
                        AsFeetable.hide();
                        AsFeetable.empty();
                        
                        AsFeeobj.getData(AsFeeCallback);
                        AsFeetable.show();
                        
                        
                    });
            
            //end ASFee callback




             </script> 
    </body>

</apex:page>